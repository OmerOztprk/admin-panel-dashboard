<div class="page-wrap">
  <h1 class="page-title gradient-text">{{ title() }}</h1>

  <div class="app-card category-form-card with-accent">
    <section class="category-form__header">
      <button class="back-btn" type="button" (click)="goBack()" aria-label="Back">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <path d="M15 18l-6-6 6-6" />
        </svg>
        <span>Back</span>
      </button>
    </section>

    <section class="form-section form-section--form">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="input-group">
          <label for="name">Name</label>
          <div class="input-wrapper" [class.error]="form.get('name')?.touched && form.get('name')?.invalid">
            <input id="name" type="text" formControlName="name" placeholder="Category name">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <rect x="3" y="6" width="18" height="12" rx="2" />
                <path d="M7 10h10M7 14h7" />
              </svg>
            </span>
          </div>
          <div class="field-error" *ngIf="form.get('name')?.touched && form.get('name')?.invalid">
            <div *ngIf="form.get('name')?.errors?.['required']">Name is required</div>
            <div *ngIf="form.get('name')?.errors?.['minlength']">Name must be at least 2 characters</div>
            <div *ngIf="form.get('name')?.errors?.['maxlength']">Name must be at most 100 characters</div>
          </div>
        </div>

        <div class="form-row">
          <div class="input-group">
            <label for="parent">Parent</label>
            <div class="input-wrapper">
              <select id="parent" formControlName="parent">
                <option [ngValue]="null">None</option>
                <option *ngFor="let c of parentOptions(); trackBy: trackById" [ngValue]="c._id"
                  [disabled]="selfDisabledOption(c)">
                  {{ c.name }}
                </option>
              </select>
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24">
                  <rect x="3" y="6" width="18" height="12" rx="2" />
                  <path d="M7 10h10M7 14h7" />
                </svg>
              </span>
            </div>
          </div>

          <div class="input-group">
            <label for="description">Description</label>
            <div class="input-wrapper"
              [class.error]="form.get('description')?.touched && form.get('description')?.invalid">
              <input id="description" type="text" formControlName="description" placeholder="Optional description">
              <span class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24">
                  <rect x="3" y="6" width="18" height="12" rx="2" />
                  <path d="M7 10h10M7 14h7" />
                </svg>
              </span>
            </div>
            <div class="field-error" *ngIf="form.get('description')?.touched && form.get('description')?.invalid">
              <div *ngIf="form.get('description')?.errors?.['maxlength']">Description must be at most 255 characters
              </div>
            </div>
          </div>
        </div>

        <div class="alert alert-error" *ngIf="error()" aria-live="assertive">{{ error() }}</div>

        <button class="btn" type="submit" [disabled]="form.invalid || saving()" [class.loading]="saving()">
          <span *ngIf="!saving()">{{ submitLabel() }}</span>
        </button>
      </form>
    </section>
  </div>
</div>